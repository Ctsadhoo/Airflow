

============================== 2024-03-27 02:50:58.774639 | 356411f2-a830-4ef6-8941-541e5aca8664 ==============================
[0m02:50:58.774639 [info ] [MainThread]: Running with dbt=1.4.7
[0m02:50:58.777040 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:50:58.778447 [debug] [MainThread]: Tracking: tracking
[0m02:50:58.781458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a59b110f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a59b117b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a59b11390>]}
[0m02:50:58.793574 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m02:50:58.798920 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:50:58.800036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '356411f2-a830-4ef6-8941-541e5aca8664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a59b117e0>]}
[0m02:50:59.546740 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m02:50:59.559664 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m02:50:59.563665 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m02:50:59.569485 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m02:50:59.713891 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_transformations.example
[0m02:50:59.720631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '356411f2-a830-4ef6-8941-541e5aca8664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a581af9a0>]}
[0m02:50:59.747291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '356411f2-a830-4ef6-8941-541e5aca8664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a59b11450>]}
[0m02:50:59.748858 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m02:50:59.749965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '356411f2-a830-4ef6-8941-541e5aca8664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a583a5c00>]}
[0m02:50:59.753191 [info ] [MainThread]: 
[0m02:50:59.755931 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:50:59.758244 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m02:50:59.769940 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m02:50:59.771361 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m02:50:59.772619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:50:59.798221 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m02:50:59.800517 [debug] [ThreadPool]: On list_destination_db: Close
[0m02:50:59.803867 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m02:50:59.810344 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m02:50:59.811614 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m02:50:59.812675 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:50:59.823915 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m02:50:59.825049 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m02:50:59.825958 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:50:59.831223 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m02:50:59.833893 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m02:50:59.837306 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m02:50:59.844151 [debug] [MainThread]: Using postgres connection "master"
[0m02:50:59.845557 [debug] [MainThread]: On master: BEGIN
[0m02:50:59.846552 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:50:59.856953 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:50:59.858315 [debug] [MainThread]: Using postgres connection "master"
[0m02:50:59.859478 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:50:59.866812 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m02:50:59.870151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '356411f2-a830-4ef6-8941-541e5aca8664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a570e37c0>]}
[0m02:50:59.871847 [debug] [MainThread]: On master: ROLLBACK
[0m02:50:59.874801 [debug] [MainThread]: Using postgres connection "master"
[0m02:50:59.875973 [debug] [MainThread]: On master: BEGIN
[0m02:50:59.880040 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:50:59.881132 [debug] [MainThread]: On master: COMMIT
[0m02:50:59.882221 [debug] [MainThread]: Using postgres connection "master"
[0m02:50:59.883076 [debug] [MainThread]: On master: COMMIT
[0m02:50:59.885740 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:50:59.886967 [debug] [MainThread]: On master: Close
[0m02:50:59.888455 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:50:59.889526 [info ] [MainThread]: 
[0m02:50:59.903849 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m02:50:59.905370 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m02:50:59.907306 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m02:50:59.908536 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m02:50:59.912433 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m02:50:59.940876 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-03-27 02:50:59.909777 => 2024-03-27 02:50:59.940750
[0m02:50:59.942291 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m02:50:59.985390 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m02:51:00.011028 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:51:00.011963 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m02:51:00.012941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:00.038171 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:51:00.039327 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:51:00.040392 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m02:51:00.043835 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m02:51:00.051209 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:51:00.052424 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m02:51:00.055157 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:51:00.060955 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:51:00.062283 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m02:51:00.065539 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:51:00.088307 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m02:51:00.089298 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:51:00.090059 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m02:51:00.094116 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:51:00.100009 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m02:51:00.101289 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m02:51:00.106626 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:51:00.108423 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-03-27 02:50:59.943262 => 2024-03-27 02:51:00.108369
[0m02:51:00.109299 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m02:51:00.110759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '356411f2-a830-4ef6-8941-541e5aca8664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a58230790>]}
[0m02:51:00.112758 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.actors ................................. [[32mCREATE VIEW[0m in 0.20s]
[0m02:51:00.114972 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m02:51:00.116554 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m02:51:00.117807 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m02:51:00.119201 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m02:51:00.120100 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m02:51:00.123620 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m02:51:00.131252 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-03-27 02:51:00.121078 => 2024-03-27 02:51:00.131108
[0m02:51:00.132572 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m02:51:00.139425 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m02:51:00.147983 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:51:00.149105 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m02:51:00.150527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:00.160081 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:51:00.161123 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:51:00.162099 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m02:51:00.164551 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m02:51:00.168340 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:51:00.170410 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m02:51:00.172862 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:51:00.177031 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:51:00.177906 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m02:51:00.180244 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:51:00.182764 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m02:51:00.184331 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:51:00.185352 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m02:51:00.188786 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:51:00.191688 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m02:51:00.192525 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m02:51:00.196340 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:51:00.198221 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-03-27 02:51:00.134544 => 2024-03-27 02:51:00.198166
[0m02:51:00.199269 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m02:51:00.201509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '356411f2-a830-4ef6-8941-541e5aca8664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a54fa88e0>]}
[0m02:51:00.203356 [info ] [Thread-1 (]: 2 of 4 OK created sql view model public.film_actors ............................ [[32mCREATE VIEW[0m in 0.08s]
[0m02:51:00.204664 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m02:51:00.205669 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m02:51:00.206693 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m02:51:00.207984 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m02:51:00.208853 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m02:51:00.212032 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m02:51:00.220633 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-03-27 02:51:00.209630 => 2024-03-27 02:51:00.220508
[0m02:51:00.221577 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m02:51:00.226482 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m02:51:00.233901 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:51:00.235142 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m02:51:00.236412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:00.244951 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:51:00.246259 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:51:00.247254 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m02:51:00.250845 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m02:51:00.254868 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:51:00.255770 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m02:51:00.257792 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:51:00.261138 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:51:00.262363 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m02:51:00.264665 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m02:51:00.268094 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m02:51:00.269722 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:51:00.270686 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m02:51:00.273975 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m02:51:00.276884 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m02:51:00.277763 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m02:51:00.281802 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m02:51:00.284103 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-03-27 02:51:00.222377 => 2024-03-27 02:51:00.284038
[0m02:51:00.285098 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m02:51:00.286635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '356411f2-a830-4ef6-8941-541e5aca8664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a54fa92d0>]}
[0m02:51:00.287739 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.films .................................. [[32mCREATE VIEW[0m in 0.08s]
[0m02:51:00.288816 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m02:51:00.290461 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m02:51:00.291867 [info ] [Thread-1 (]: 4 of 4 START sql view model public.film_ratings ................................ [RUN]
[0m02:51:00.293391 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m02:51:00.294226 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m02:51:00.298124 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m02:51:00.307954 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-03-27 02:51:00.294954 => 2024-03-27 02:51:00.307805
[0m02:51:00.309072 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m02:51:00.316734 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m02:51:00.327846 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:51:00.328774 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m02:51:00.329642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:00.342461 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m02:51:00.343873 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m02:51:00.344735 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  create view "destination_db"."public"."film_ratings__dbt_tmp" as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT  
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" film_actors
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title 
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
[0m02:51:00.347407 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 18:     FROM "destination_db"."public"."films"
                  ^

[0m02:51:00.349439 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m02:51:00.353062 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-03-27 02:51:00.309927 => 2024-03-27 02:51:00.352954
[0m02:51:00.354395 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m02:51:00.357394 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  relation "public.films" does not exist
  LINE 18:     FROM "destination_db"."public"."films"
                    ^
  compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m02:51:00.358511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '356411f2-a830-4ef6-8941-541e5aca8664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a54fa88e0>]}
[0m02:51:00.359505 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model public.film_ratings ....................... [[31mERROR[0m in 0.07s]
[0m02:51:00.360481 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m02:51:00.362711 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:51:00.363680 [debug] [MainThread]: Using postgres connection "master"
[0m02:51:00.364674 [debug] [MainThread]: On master: BEGIN
[0m02:51:00.365611 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:51:00.375917 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m02:51:00.377136 [debug] [MainThread]: On master: COMMIT
[0m02:51:00.377867 [debug] [MainThread]: Using postgres connection "master"
[0m02:51:00.378607 [debug] [MainThread]: On master: COMMIT
[0m02:51:00.380502 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m02:51:00.381415 [debug] [MainThread]: On master: Close
[0m02:51:00.382857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:51:00.384533 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m02:51:00.385672 [info ] [MainThread]: 
[0m02:51:00.386958 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m02:51:00.388190 [debug] [MainThread]: Command end result
[0m02:51:00.408202 [info ] [MainThread]: 
[0m02:51:00.409381 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:51:00.410527 [info ] [MainThread]: 
[0m02:51:00.411628 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m02:51:00.412729 [error] [MainThread]:   relation "public.films" does not exist
[0m02:51:00.413789 [error] [MainThread]:   LINE 18:     FROM "destination_db"."public"."films"
[0m02:51:00.414824 [error] [MainThread]:                     ^
[0m02:51:00.416750 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m02:51:00.418201 [info ] [MainThread]: 
[0m02:51:00.419300 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m02:51:00.420855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a583a5c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a54fcb6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a54fcb2b0>]}
[0m02:51:00.421914 [debug] [MainThread]: Flushing usage events


============================== 2024-03-27 02:58:53.445249 | ebca9cde-0b4d-4904-bf92-48d4b62dea1c ==============================
[0m02:58:53.445249 [info ] [MainThread]: Running with dbt=1.4.7
[0m02:58:53.447553 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:58:53.448650 [debug] [MainThread]: Tracking: tracking
[0m02:58:53.450737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1ef6cd0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1ef6cd7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1ef6cd390>]}
[0m02:58:53.466865 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m02:58:53.613422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:58:53.614828 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:58:53.616561 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_transformations.example
[0m02:58:53.624642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebca9cde-0b4d-4904-bf92-48d4b62dea1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1ede00a60>]}
[0m02:58:53.648848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebca9cde-0b4d-4904-bf92-48d4b62dea1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1edf26050>]}
[0m02:58:53.650314 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m02:58:53.651556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebca9cde-0b4d-4904-bf92-48d4b62dea1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1edf260b0>]}
[0m02:58:53.654111 [info ] [MainThread]: 
[0m02:58:53.656709 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:58:53.659022 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m02:58:53.670634 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m02:58:53.672156 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m02:58:53.673614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:58:53.691503 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m02:58:53.695103 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m02:58:53.696514 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m02:58:53.697910 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m02:58:53.699058 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m02:58:53.700358 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m02:58:53.702330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:58:53.703567 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m02:58:53.704855 [info ] [MainThread]: 
[0m02:58:53.705975 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m02:58:53.707478 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  
[0m02:58:53.708612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1edf25ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1ede4f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1ede4fa60>]}
[0m02:58:53.709682 [debug] [MainThread]: Flushing usage events


============================== 2024-03-27 03:01:20.023035 | 46487f3f-13ea-4d6f-89b0-18df2ad07126 ==============================
[0m03:01:20.023035 [info ] [MainThread]: Running with dbt=1.4.7
[0m03:01:20.025378 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:01:20.026749 [debug] [MainThread]: Tracking: tracking
[0m03:01:20.028995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9bfa1360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9bfa17e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9bfa13c0>]}
[0m03:01:20.048229 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m03:01:20.201326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:01:20.202681 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:01:20.204659 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_transformations.example
[0m03:01:20.213741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46487f3f-13ea-4d6f-89b0-18df2ad07126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9a6d4af0>]}
[0m03:01:20.236519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46487f3f-13ea-4d6f-89b0-18df2ad07126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9a7fa0e0>]}
[0m03:01:20.238179 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m03:01:20.239328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46487f3f-13ea-4d6f-89b0-18df2ad07126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9a7fa140>]}
[0m03:01:20.242523 [info ] [MainThread]: 
[0m03:01:20.245207 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:01:20.247492 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m03:01:20.259324 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m03:01:20.260797 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m03:01:20.262125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:01:20.277787 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m03:01:20.279747 [debug] [ThreadPool]: On list_destination_db: Close
[0m03:01:20.282148 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m03:01:20.288903 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m03:01:20.290274 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m03:01:20.291567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:01:20.302100 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m03:01:20.303349 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m03:01:20.304382 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:01:20.308615 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m03:01:20.310626 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m03:01:20.313190 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m03:01:20.319861 [debug] [MainThread]: Using postgres connection "master"
[0m03:01:20.321305 [debug] [MainThread]: On master: BEGIN
[0m03:01:20.322453 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:01:20.333343 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:01:20.334525 [debug] [MainThread]: Using postgres connection "master"
[0m03:01:20.335454 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:01:20.342397 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m03:01:20.344383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46487f3f-13ea-4d6f-89b0-18df2ad07126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9a71f850>]}
[0m03:01:20.345567 [debug] [MainThread]: On master: ROLLBACK
[0m03:01:20.348085 [debug] [MainThread]: Using postgres connection "master"
[0m03:01:20.349276 [debug] [MainThread]: On master: BEGIN
[0m03:01:20.353834 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:01:20.355153 [debug] [MainThread]: On master: COMMIT
[0m03:01:20.356239 [debug] [MainThread]: Using postgres connection "master"
[0m03:01:20.357563 [debug] [MainThread]: On master: COMMIT
[0m03:01:20.360497 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m03:01:20.361651 [debug] [MainThread]: On master: Close
[0m03:01:20.363151 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:01:20.364248 [info ] [MainThread]: 
[0m03:01:20.378072 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m03:01:20.379677 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m03:01:20.381702 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m03:01:20.382786 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m03:01:20.386649 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m03:01:20.400612 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-03-27 03:01:20.384051 => 2024-03-27 03:01:20.400501
[0m03:01:20.401958 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m03:01:20.439851 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m03:01:20.452226 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m03:01:20.453502 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m03:01:20.454741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:01:20.466205 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:01:20.467387 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m03:01:20.468279 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m03:01:20.471740 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m03:01:20.478448 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m03:01:20.479609 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m03:01:20.482859 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:01:20.486135 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m03:01:20.487158 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m03:01:20.490688 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:01:20.508991 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m03:01:20.510280 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m03:01:20.511337 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m03:01:20.515776 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m03:01:20.521436 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m03:01:20.522616 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m03:01:20.527995 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m03:01:20.530226 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-03-27 03:01:20.403106 => 2024-03-27 03:01:20.530169
[0m03:01:20.531201 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m03:01:20.532678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46487f3f-13ea-4d6f-89b0-18df2ad07126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9a5a2b30>]}
[0m03:01:20.533816 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.actors ................................. [[32mCREATE VIEW[0m in 0.15s]
[0m03:01:20.536454 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m03:01:20.537985 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m03:01:20.539146 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m03:01:20.540614 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m03:01:20.541784 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m03:01:20.545127 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m03:01:20.554235 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-03-27 03:01:20.542767 => 2024-03-27 03:01:20.554055
[0m03:01:20.555491 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m03:01:20.560679 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m03:01:20.569810 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m03:01:20.570897 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m03:01:20.571810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:01:20.582548 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:01:20.583594 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m03:01:20.584468 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m03:01:20.587300 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m03:01:20.591246 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m03:01:20.592420 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m03:01:20.595441 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:01:20.598985 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m03:01:20.600101 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m03:01:20.603575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:01:20.606909 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m03:01:20.608187 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m03:01:20.609295 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m03:01:20.613505 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m03:01:20.617525 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m03:01:20.618723 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m03:01:20.623916 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m03:01:20.625900 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-03-27 03:01:20.556711 => 2024-03-27 03:01:20.625848
[0m03:01:20.627125 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m03:01:20.628663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46487f3f-13ea-4d6f-89b0-18df2ad07126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9a5fd3f0>]}
[0m03:01:20.629977 [info ] [Thread-1 (]: 2 of 4 OK created sql view model public.film_actors ............................ [[32mCREATE VIEW[0m in 0.09s]
[0m03:01:20.631447 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m03:01:20.632895 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m03:01:20.634290 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m03:01:20.635722 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m03:01:20.637061 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m03:01:20.641910 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m03:01:20.651248 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-03-27 03:01:20.638322 => 2024-03-27 03:01:20.651035
[0m03:01:20.652443 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m03:01:20.657422 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m03:01:20.667600 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m03:01:20.668673 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m03:01:20.669642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:01:20.680159 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:01:20.681295 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m03:01:20.682318 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m03:01:20.686241 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m03:01:20.690361 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m03:01:20.691824 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m03:01:20.694858 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:01:20.698691 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m03:01:20.699753 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m03:01:20.702620 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:01:20.705484 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m03:01:20.706775 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m03:01:20.707970 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m03:01:20.712280 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m03:01:20.715345 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m03:01:20.716333 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m03:01:20.721264 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m03:01:20.723739 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-03-27 03:01:20.653420 => 2024-03-27 03:01:20.723679
[0m03:01:20.724903 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m03:01:20.726720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46487f3f-13ea-4d6f-89b0-18df2ad07126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9a54d330>]}
[0m03:01:20.728104 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.films .................................. [[32mCREATE VIEW[0m in 0.09s]
[0m03:01:20.729336 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m03:01:20.730806 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m03:01:20.732411 [info ] [Thread-1 (]: 4 of 4 START sql view model public.film_ratings ................................ [RUN]
[0m03:01:20.733945 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m03:01:20.735043 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m03:01:20.740949 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m03:01:20.751918 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-03-27 03:01:20.736392 => 2024-03-27 03:01:20.751716
[0m03:01:20.753143 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m03:01:20.758257 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m03:01:20.767087 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m03:01:20.768332 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m03:01:20.769319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:01:20.778649 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:01:20.779581 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m03:01:20.780291 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  create view "destination_db"."public"."film_ratings__dbt_tmp" as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT  
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" film_actors
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title 
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
[0m03:01:20.782379 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 18:     FROM "destination_db"."public"."films"
                  ^

[0m03:01:20.783413 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m03:01:20.785507 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-03-27 03:01:20.754186 => 2024-03-27 03:01:20.785428
[0m03:01:20.786345 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m03:01:20.788563 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  relation "public.films" does not exist
  LINE 18:     FROM "destination_db"."public"."films"
                    ^
  compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m03:01:20.789801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46487f3f-13ea-4d6f-89b0-18df2ad07126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9a725cf0>]}
[0m03:01:20.791228 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model public.film_ratings ....................... [[31mERROR[0m in 0.06s]
[0m03:01:20.792241 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m03:01:20.794388 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:01:20.795343 [debug] [MainThread]: Using postgres connection "master"
[0m03:01:20.796172 [debug] [MainThread]: On master: BEGIN
[0m03:01:20.796975 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:01:20.805211 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:01:20.806353 [debug] [MainThread]: On master: COMMIT
[0m03:01:20.807379 [debug] [MainThread]: Using postgres connection "master"
[0m03:01:20.808675 [debug] [MainThread]: On master: COMMIT
[0m03:01:20.810634 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m03:01:20.811576 [debug] [MainThread]: On master: Close
[0m03:01:20.812768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:01:20.813884 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m03:01:20.814807 [info ] [MainThread]: 
[0m03:01:20.815795 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m03:01:20.816887 [debug] [MainThread]: Command end result
[0m03:01:20.834224 [info ] [MainThread]: 
[0m03:01:20.835376 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:01:20.836366 [info ] [MainThread]: 
[0m03:01:20.837366 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m03:01:20.838467 [error] [MainThread]:   relation "public.films" does not exist
[0m03:01:20.839586 [error] [MainThread]:   LINE 18:     FROM "destination_db"."public"."films"
[0m03:01:20.840768 [error] [MainThread]:                     ^
[0m03:01:20.841968 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m03:01:20.843077 [info ] [MainThread]: 
[0m03:01:20.844108 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m03:01:20.845448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9a60bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9a60bac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b9a60bb80>]}
[0m03:01:20.846517 [debug] [MainThread]: Flushing usage events


============================== 2024-03-27 03:07:06.754008 | 47e77971-1314-488c-928c-5ec6e45a3aa1 ==============================
[0m03:07:06.754008 [info ] [MainThread]: Running with dbt=1.4.7
[0m03:07:06.756184 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:07:06.757363 [debug] [MainThread]: Tracking: tracking
[0m03:07:06.759415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72e52a10f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72e52a17b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72e52a1390>]}
[0m03:07:06.776640 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m03:07:06.951406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:07:06.953180 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m03:07:06.975229 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m03:07:07.045212 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_transformations.example
[0m03:07:07.052263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47e77971-1314-488c-928c-5ec6e45a3aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72e3a24130>]}
[0m03:07:07.072348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47e77971-1314-488c-928c-5ec6e45a3aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72e52726b0>]}
[0m03:07:07.073769 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m03:07:07.074869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47e77971-1314-488c-928c-5ec6e45a3aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72e52b81f0>]}
[0m03:07:07.077494 [info ] [MainThread]: 
[0m03:07:07.080088 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:07:07.082393 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m03:07:07.093800 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m03:07:07.095059 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m03:07:07.096378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:07:07.111502 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m03:07:07.113600 [debug] [ThreadPool]: On list_destination_db: Close
[0m03:07:07.116443 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m03:07:07.123341 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m03:07:07.124728 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m03:07:07.126043 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:07:07.137157 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m03:07:07.138337 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m03:07:07.139479 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:07:07.143920 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m03:07:07.146067 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m03:07:07.148913 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m03:07:07.156337 [debug] [MainThread]: Using postgres connection "master"
[0m03:07:07.157677 [debug] [MainThread]: On master: BEGIN
[0m03:07:07.158860 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:07:07.169437 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:07:07.170618 [debug] [MainThread]: Using postgres connection "master"
[0m03:07:07.171561 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:07:07.178200 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m03:07:07.180425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47e77971-1314-488c-928c-5ec6e45a3aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72e2867310>]}
[0m03:07:07.182122 [debug] [MainThread]: On master: ROLLBACK
[0m03:07:07.185179 [debug] [MainThread]: Using postgres connection "master"
[0m03:07:07.186430 [debug] [MainThread]: On master: BEGIN
[0m03:07:07.190029 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:07:07.191236 [debug] [MainThread]: On master: COMMIT
[0m03:07:07.192250 [debug] [MainThread]: Using postgres connection "master"
[0m03:07:07.193218 [debug] [MainThread]: On master: COMMIT
[0m03:07:07.195366 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m03:07:07.196315 [debug] [MainThread]: On master: Close
[0m03:07:07.197616 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:07:07.198681 [info ] [MainThread]: 
[0m03:07:07.212293 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m03:07:07.213669 [info ] [Thread-1 (]: 1 of 4 START sql view model public.actors ...................................... [RUN]
[0m03:07:07.215149 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m03:07:07.216319 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m03:07:07.220013 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m03:07:07.231501 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-03-27 03:07:07.217584 => 2024-03-27 03:07:07.231381
[0m03:07:07.232970 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m03:07:07.270095 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m03:07:07.280439 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m03:07:07.281490 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m03:07:07.282537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:07:07.291918 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:07:07.292900 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m03:07:07.293760 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  create view "destination_db"."public"."actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."actors"
  );
[0m03:07:07.296976 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m03:07:07.303792 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m03:07:07.305360 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m03:07:07.308467 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:07:07.311806 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m03:07:07.312856 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m03:07:07.315998 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:07:07.334914 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m03:07:07.336247 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m03:07:07.337386 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m03:07:07.341491 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m03:07:07.347120 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m03:07:07.348424 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m03:07:07.353717 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m03:07:07.355783 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-03-27 03:07:07.234092 => 2024-03-27 03:07:07.355722
[0m03:07:07.356797 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m03:07:07.358193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47e77971-1314-488c-928c-5ec6e45a3aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72e28da8c0>]}
[0m03:07:07.359327 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.actors ................................. [[32mCREATE VIEW[0m in 0.14s]
[0m03:07:07.361806 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m03:07:07.363083 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m03:07:07.364312 [info ] [Thread-1 (]: 2 of 4 START sql view model public.film_actors ................................. [RUN]
[0m03:07:07.365655 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m03:07:07.366795 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m03:07:07.370388 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m03:07:07.381508 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-03-27 03:07:07.367941 => 2024-03-27 03:07:07.381379
[0m03:07:07.382809 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m03:07:07.388290 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m03:07:07.399272 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m03:07:07.400513 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m03:07:07.401662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:07:07.410880 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:07:07.412083 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m03:07:07.413126 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  create view "destination_db"."public"."film_actors__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
[0m03:07:07.416928 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m03:07:07.420967 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m03:07:07.422277 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m03:07:07.425084 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:07:07.429287 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m03:07:07.430408 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m03:07:07.433617 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:07:07.436480 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m03:07:07.437607 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m03:07:07.438727 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m03:07:07.442866 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m03:07:07.446058 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m03:07:07.447235 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m03:07:07.451994 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m03:07:07.454125 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-03-27 03:07:07.384121 => 2024-03-27 03:07:07.454068
[0m03:07:07.455072 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m03:07:07.456484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47e77971-1314-488c-928c-5ec6e45a3aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72e28dac50>]}
[0m03:07:07.457651 [info ] [Thread-1 (]: 2 of 4 OK created sql view model public.film_actors ............................ [[32mCREATE VIEW[0m in 0.09s]
[0m03:07:07.458739 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m03:07:07.459945 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m03:07:07.461304 [info ] [Thread-1 (]: 3 of 4 START sql view model public.films ....................................... [RUN]
[0m03:07:07.462717 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m03:07:07.463764 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m03:07:07.467245 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m03:07:07.476795 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-03-27 03:07:07.464680 => 2024-03-27 03:07:07.476656
[0m03:07:07.478057 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m03:07:07.483549 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m03:07:07.492334 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m03:07:07.493445 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m03:07:07.494404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:07:07.504584 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:07:07.505763 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m03:07:07.506658 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  create view "destination_db"."public"."films__dbt_tmp" as (
    SELECT * FROM "destination_db"."public"."films"
  );
[0m03:07:07.510140 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m03:07:07.513733 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m03:07:07.514842 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m03:07:07.517860 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:07:07.521677 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m03:07:07.522724 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m03:07:07.525593 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:07:07.528163 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m03:07:07.529148 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m03:07:07.530080 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m03:07:07.533889 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m03:07:07.537204 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m03:07:07.538300 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m03:07:07.543104 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m03:07:07.545184 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-03-27 03:07:07.479089 => 2024-03-27 03:07:07.545123
[0m03:07:07.546122 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m03:07:07.547404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47e77971-1314-488c-928c-5ec6e45a3aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72e3a25d80>]}
[0m03:07:07.548440 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.films .................................. [[32mCREATE VIEW[0m in 0.08s]
[0m03:07:07.549628 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m03:07:07.551497 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m03:07:07.552781 [info ] [Thread-1 (]: 4 of 4 START sql view model public.film_ratings ................................ [RUN]
[0m03:07:07.554183 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m03:07:07.555273 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m03:07:07.559272 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m03:07:07.567615 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-03-27 03:07:07.556185 => 2024-03-27 03:07:07.567358
[0m03:07:07.569092 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m03:07:07.574109 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m03:07:07.583049 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m03:07:07.584187 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m03:07:07.585268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:07:07.595151 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:07:07.596154 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m03:07:07.597073 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  create view "destination_db"."public"."film_ratings__dbt_tmp" as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT  
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title 
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
[0m03:07:07.599667 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 18:     FROM "destination_db"."public"."films"
                  ^

[0m03:07:07.601032 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m03:07:07.603239 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-03-27 03:07:07.570044 => 2024-03-27 03:07:07.603150
[0m03:07:07.604264 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m03:07:07.606514 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  relation "public.films" does not exist
  LINE 18:     FROM "destination_db"."public"."films"
                    ^
  compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m03:07:07.607587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47e77971-1314-488c-928c-5ec6e45a3aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72e392df30>]}
[0m03:07:07.608554 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model public.film_ratings ....................... [[31mERROR[0m in 0.05s]
[0m03:07:07.609560 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m03:07:07.611564 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:07:07.612406 [debug] [MainThread]: Using postgres connection "master"
[0m03:07:07.613363 [debug] [MainThread]: On master: BEGIN
[0m03:07:07.614165 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:07:07.622966 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:07:07.623971 [debug] [MainThread]: On master: COMMIT
[0m03:07:07.624930 [debug] [MainThread]: Using postgres connection "master"
[0m03:07:07.625731 [debug] [MainThread]: On master: COMMIT
[0m03:07:07.627696 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m03:07:07.628536 [debug] [MainThread]: On master: Close
[0m03:07:07.629725 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:07:07.630606 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m03:07:07.631587 [info ] [MainThread]: 
[0m03:07:07.633690 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m03:07:07.635244 [debug] [MainThread]: Command end result
[0m03:07:07.652732 [info ] [MainThread]: 
[0m03:07:07.653902 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:07:07.654913 [info ] [MainThread]: 
[0m03:07:07.655983 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m03:07:07.657172 [error] [MainThread]:   relation "public.films" does not exist
[0m03:07:07.658214 [error] [MainThread]:   LINE 18:     FROM "destination_db"."public"."films"
[0m03:07:07.659338 [error] [MainThread]:                     ^
[0m03:07:07.660221 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m03:07:07.661287 [info ] [MainThread]: 
[0m03:07:07.662210 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m03:07:07.663637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72e278dab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72e278f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72e278d8d0>]}
[0m03:07:07.664732 [debug] [MainThread]: Flushing usage events


============================== 2024-03-27 03:27:25.524954 | 33775965-4b6b-47af-9424-0325170a7d9e ==============================
[0m03:27:25.524954 [info ] [MainThread]: Running with dbt=1.4.7
[0m03:27:25.527367 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:27:25.528606 [debug] [MainThread]: Tracking: tracking
[0m03:27:25.531800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22c8e5360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22c8e57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22c8e53c0>]}
[0m03:27:25.551634 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m03:27:25.571264 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m03:27:25.572791 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:27:25.573906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '33775965-4b6b-47af-9424-0325170a7d9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22c8e4130>]}
[0m03:27:26.296620 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m03:27:26.309513 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m03:27:26.313989 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m03:27:26.319299 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m03:27:26.460644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33775965-4b6b-47af-9424-0325170a7d9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22b0ceb90>]}
[0m03:27:26.482713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33775965-4b6b-47af-9424-0325170a7d9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22c8e5600>]}
[0m03:27:26.484027 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m03:27:26.485203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33775965-4b6b-47af-9424-0325170a7d9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22c8e1a50>]}
[0m03:27:26.488432 [info ] [MainThread]: 
[0m03:27:26.491483 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:27:26.493947 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m03:27:26.508680 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m03:27:26.510145 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m03:27:26.511382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:27:26.526344 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m03:27:26.528463 [debug] [ThreadPool]: On list_destination_db: Close
[0m03:27:26.531141 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m03:27:26.538345 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m03:27:26.539608 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m03:27:26.540857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:27:26.553285 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m03:27:26.554406 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m03:27:26.555499 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:27:26.559756 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m03:27:26.562004 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m03:27:26.564851 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m03:27:26.572010 [debug] [MainThread]: Using postgres connection "master"
[0m03:27:26.573391 [debug] [MainThread]: On master: BEGIN
[0m03:27:26.574490 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:27:26.587143 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:27:26.588250 [debug] [MainThread]: Using postgres connection "master"
[0m03:27:26.589469 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:27:26.597258 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m03:27:26.599397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33775965-4b6b-47af-9424-0325170a7d9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22afaa650>]}
[0m03:27:26.600974 [debug] [MainThread]: On master: ROLLBACK
[0m03:27:26.603955 [debug] [MainThread]: Using postgres connection "master"
[0m03:27:26.605155 [debug] [MainThread]: On master: BEGIN
[0m03:27:26.608586 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:27:26.609708 [debug] [MainThread]: On master: COMMIT
[0m03:27:26.610962 [debug] [MainThread]: Using postgres connection "master"
[0m03:27:26.612160 [debug] [MainThread]: On master: COMMIT
[0m03:27:26.614873 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m03:27:26.616729 [debug] [MainThread]: On master: Close
[0m03:27:26.618347 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:27:26.619364 [info ] [MainThread]: 
[0m03:27:26.633460 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m03:27:26.634770 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m03:27:26.636223 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m03:27:26.637317 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m03:27:26.640744 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m03:27:26.652163 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-03-27 03:27:26.638371 => 2024-03-27 03:27:26.652042
[0m03:27:26.653325 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m03:27:26.693932 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m03:27:26.703477 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m03:27:26.704801 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m03:27:26.705946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:27:26.717106 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:27:26.718166 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m03:27:26.719523 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m03:27:26.726970 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m03:27:26.733688 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m03:27:26.735157 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m03:27:26.737704 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:27:26.740892 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m03:27:26.741843 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m03:27:26.743991 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:27:26.767692 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m03:27:26.768773 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m03:27:26.769741 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m03:27:26.773441 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m03:27:26.779597 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m03:27:26.780760 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m03:27:26.785738 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m03:27:26.787839 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-03-27 03:27:26.654407 => 2024-03-27 03:27:26.787780
[0m03:27:26.788706 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m03:27:26.790132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33775965-4b6b-47af-9424-0325170a7d9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa229f652a0>]}
[0m03:27:26.791603 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.15s]
[0m03:27:26.794487 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m03:27:26.795974 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m03:27:26.797250 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m03:27:26.798832 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m03:27:26.800149 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m03:27:26.803610 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m03:27:26.813242 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-03-27 03:27:26.801137 => 2024-03-27 03:27:26.813054
[0m03:27:26.815011 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m03:27:26.820246 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m03:27:26.829105 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m03:27:26.830595 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m03:27:26.831761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:27:26.841364 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:27:26.842518 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m03:27:26.843424 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m03:27:26.850999 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m03:27:26.854521 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m03:27:26.855672 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m03:27:26.858141 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:27:26.861598 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m03:27:26.862573 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m03:27:26.865285 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:27:26.868388 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m03:27:26.869366 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m03:27:26.870284 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m03:27:26.874014 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m03:27:26.877459 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m03:27:26.878783 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m03:27:26.883527 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m03:27:26.885897 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-03-27 03:27:26.816220 => 2024-03-27 03:27:26.885841
[0m03:27:26.886911 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m03:27:26.888504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33775965-4b6b-47af-9424-0325170a7d9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22afa9150>]}
[0m03:27:26.889727 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.09s]
[0m03:27:26.890827 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m03:27:26.891847 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m03:27:26.892759 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m03:27:26.893979 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m03:27:26.895153 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m03:27:26.899850 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m03:27:26.906966 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-03-27 03:27:26.896065 => 2024-03-27 03:27:26.906764
[0m03:27:26.908380 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m03:27:26.912969 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m03:27:26.921256 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m03:27:26.922413 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m03:27:26.923412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:27:26.934221 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:27:26.935367 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m03:27:26.936313 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m03:27:26.942165 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m03:27:26.945812 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m03:27:26.947101 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m03:27:26.949971 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:27:26.953592 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m03:27:26.954548 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m03:27:26.956711 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:27:26.959316 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m03:27:26.960123 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m03:27:26.960838 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m03:27:26.964107 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m03:27:26.967129 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m03:27:26.968232 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m03:27:26.972556 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m03:27:26.974538 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-03-27 03:27:26.909092 => 2024-03-27 03:27:26.974483
[0m03:27:26.975404 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m03:27:26.976595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33775965-4b6b-47af-9424-0325170a7d9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa229da58d0>]}
[0m03:27:26.977613 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.08s]
[0m03:27:26.978747 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m03:27:26.980431 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m03:27:26.981635 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m03:27:26.983367 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m03:27:26.984649 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m03:27:26.988966 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m03:27:26.996561 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-03-27 03:27:26.985653 => 2024-03-27 03:27:26.996343
[0m03:27:26.998087 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m03:27:27.003800 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m03:27:27.011729 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m03:27:27.012867 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m03:27:27.014369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:27:27.024338 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m03:27:27.025323 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m03:27:27.026144 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT  
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title 
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m03:27:27.037353 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m03:27:27.040607 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m03:27:27.041377 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m03:27:27.043457 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m03:27:27.046545 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m03:27:27.048160 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m03:27:27.049166 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m03:27:27.052972 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m03:27:27.055886 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m03:27:27.056717 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m03:27:27.058632 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m03:27:27.060386 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-03-27 03:27:26.999057 => 2024-03-27 03:27:27.060334
[0m03:27:27.061227 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m03:27:27.062720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33775965-4b6b-47af-9424-0325170a7d9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22afde0e0>]}
[0m03:27:27.064001 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.08s]
[0m03:27:27.065396 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m03:27:27.067651 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:27:27.068560 [debug] [MainThread]: Using postgres connection "master"
[0m03:27:27.069371 [debug] [MainThread]: On master: BEGIN
[0m03:27:27.070108 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:27:27.078050 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m03:27:27.079142 [debug] [MainThread]: On master: COMMIT
[0m03:27:27.080270 [debug] [MainThread]: Using postgres connection "master"
[0m03:27:27.081372 [debug] [MainThread]: On master: COMMIT
[0m03:27:27.084462 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m03:27:27.085382 [debug] [MainThread]: On master: Close
[0m03:27:27.086595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:27:27.087391 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m03:27:27.088241 [info ] [MainThread]: 
[0m03:27:27.089122 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m03:27:27.090199 [debug] [MainThread]: Command end result
[0m03:27:27.138675 [info ] [MainThread]: 
[0m03:27:27.140040 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:27:27.141310 [info ] [MainThread]: 
[0m03:27:27.142351 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m03:27:27.143420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22c919240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22c91b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa22da60460>]}
[0m03:27:27.144480 [debug] [MainThread]: Flushing usage events


============================== 2024-03-27 13:03:27.693685 | 7a4cc149-5c5c-4ba7-92cf-71ed68776b92 ==============================
[0m13:03:27.693685 [info ] [MainThread]: Running with dbt=1.4.7
[0m13:03:27.696507 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:03:27.698215 [debug] [MainThread]: Tracking: tracking
[0m13:03:27.701988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30289c50f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30289c57b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30289c5390>]}
[0m13:03:27.719747 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m13:03:27.921099 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:03:27.922413 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:03:27.929971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a4cc149-5c5c-4ba7-92cf-71ed68776b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3027100a30>]}
[0m13:03:27.951038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a4cc149-5c5c-4ba7-92cf-71ed68776b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3027052050>]}
[0m13:03:27.952345 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:03:27.953568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a4cc149-5c5c-4ba7-92cf-71ed68776b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30270520b0>]}
[0m13:03:27.956092 [info ] [MainThread]: 
[0m13:03:27.958679 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:03:27.960691 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m13:03:27.972679 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m13:03:27.973972 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m13:03:27.975073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:27.992601 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m13:03:27.994859 [debug] [ThreadPool]: On list_destination_db: Close
[0m13:03:27.997638 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m13:03:28.004552 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:03:28.005736 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m13:03:28.006832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:03:28.017283 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:03:28.018405 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:03:28.019301 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:03:28.023487 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m13:03:28.025588 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m13:03:28.027993 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m13:03:28.035000 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:28.036227 [debug] [MainThread]: On master: BEGIN
[0m13:03:28.037317 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:03:28.046694 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:03:28.048290 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:28.049132 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:03:28.056278 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m13:03:28.058650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a4cc149-5c5c-4ba7-92cf-71ed68776b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3026f53850>]}
[0m13:03:28.059962 [debug] [MainThread]: On master: ROLLBACK
[0m13:03:28.062622 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:28.064174 [debug] [MainThread]: On master: BEGIN
[0m13:03:28.068515 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:03:28.069699 [debug] [MainThread]: On master: COMMIT
[0m13:03:28.070594 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:28.071489 [debug] [MainThread]: On master: COMMIT
[0m13:03:28.073596 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:03:28.074522 [debug] [MainThread]: On master: Close
[0m13:03:28.075730 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:03:28.076733 [info ] [MainThread]: 
[0m13:03:28.090093 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m13:03:28.091610 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m13:03:28.093261 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m13:03:28.094444 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m13:03:28.098139 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m13:03:28.109098 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-03-27 13:03:28.095586 => 2024-03-27 13:03:28.108922
[0m13:03:28.110169 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m13:03:28.151396 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m13:03:28.159714 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:03:28.160809 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m13:03:28.161834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:28.172260 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:03:28.173267 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:03:28.174242 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m13:03:28.184670 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:03:28.192004 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:03:28.193322 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m13:03:28.197148 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:03:28.201134 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:03:28.202273 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m13:03:28.205232 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:03:28.228887 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m13:03:28.230302 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:03:28.231425 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m13:03:28.235493 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:03:28.241535 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:03:28.242723 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m13:03:28.247700 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:03:28.249953 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-03-27 13:03:28.111195 => 2024-03-27 13:03:28.249890
[0m13:03:28.250981 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m13:03:28.252327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a4cc149-5c5c-4ba7-92cf-71ed68776b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3026fcd5a0>]}
[0m13:03:28.253659 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.16s]
[0m13:03:28.256233 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m13:03:28.257754 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m13:03:28.259005 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m13:03:28.260566 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m13:03:28.261789 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m13:03:28.265688 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m13:03:28.275379 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-03-27 13:03:28.262827 => 2024-03-27 13:03:28.275157
[0m13:03:28.276607 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m13:03:28.282631 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m13:03:28.292141 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:03:28.293074 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m13:03:28.293994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:28.303792 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:03:28.305098 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:03:28.306065 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m13:03:28.312673 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:03:28.316509 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:03:28.317611 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m13:03:28.320052 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:03:28.323234 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:03:28.324007 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m13:03:28.326339 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:03:28.329253 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m13:03:28.330289 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:03:28.331723 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m13:03:28.335044 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:03:28.338915 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:03:28.339962 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m13:03:28.343988 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:03:28.346259 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-03-27 13:03:28.277519 => 2024-03-27 13:03:28.346199
[0m13:03:28.347272 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m13:03:28.348639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a4cc149-5c5c-4ba7-92cf-71ed68776b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302702e260>]}
[0m13:03:28.349910 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.09s]
[0m13:03:28.351313 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m13:03:28.352356 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m13:03:28.353490 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m13:03:28.354824 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m13:03:28.355703 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m13:03:28.358876 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m13:03:28.367371 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-03-27 13:03:28.356444 => 2024-03-27 13:03:28.367237
[0m13:03:28.368444 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m13:03:28.374158 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m13:03:28.383364 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:03:28.384547 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m13:03:28.385457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:28.395286 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:03:28.396434 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:03:28.397325 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m13:03:28.403791 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:03:28.407163 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:03:28.407952 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m13:03:28.410014 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:03:28.413694 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:03:28.414976 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m13:03:28.417346 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:03:28.420102 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m13:03:28.420995 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:03:28.421738 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m13:03:28.424589 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:03:28.427547 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:03:28.428380 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m13:03:28.432801 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:03:28.434904 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-03-27 13:03:28.369412 => 2024-03-27 13:03:28.434851
[0m13:03:28.435729 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m13:03:28.436941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a4cc149-5c5c-4ba7-92cf-71ed68776b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f302702e5f0>]}
[0m13:03:28.437976 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.08s]
[0m13:03:28.439060 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m13:03:28.440993 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m13:03:28.442062 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m13:03:28.443434 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m13:03:28.444358 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m13:03:28.449038 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m13:03:28.456843 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-03-27 13:03:28.445362 => 2024-03-27 13:03:28.456656
[0m13:03:28.458068 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m13:03:28.463103 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m13:03:28.471122 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:03:28.472124 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m13:03:28.472892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:28.482336 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:03:28.483480 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:03:28.484386 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT  
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title 
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m13:03:28.494984 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:03:28.498660 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:03:28.499664 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m13:03:28.501816 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:03:28.504163 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m13:03:28.504920 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:03:28.505652 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m13:03:28.508735 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:03:28.511687 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:03:28.512660 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m13:03:28.515072 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:03:28.518592 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-03-27 13:03:28.458822 => 2024-03-27 13:03:28.518531
[0m13:03:28.519431 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m13:03:28.520746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a4cc149-5c5c-4ba7-92cf-71ed68776b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3024e50670>]}
[0m13:03:28.521932 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.08s]
[0m13:03:28.523172 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m13:03:28.525614 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:03:28.526708 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:28.527720 [debug] [MainThread]: On master: BEGIN
[0m13:03:28.528781 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:03:28.538674 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:03:28.539765 [debug] [MainThread]: On master: COMMIT
[0m13:03:28.540682 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:28.541597 [debug] [MainThread]: On master: COMMIT
[0m13:03:28.543893 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:03:28.547109 [debug] [MainThread]: On master: Close
[0m13:03:28.548865 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:03:28.550749 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m13:03:28.551899 [info ] [MainThread]: 
[0m13:03:28.552973 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m13:03:28.554385 [debug] [MainThread]: Command end result
[0m13:03:28.570393 [info ] [MainThread]: 
[0m13:03:28.571603 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:03:28.572679 [info ] [MainThread]: 
[0m13:03:28.573826 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:03:28.575043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3024e34220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3024e529b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3024e52ad0>]}
[0m13:03:28.576173 [debug] [MainThread]: Flushing usage events


============================== 2024-03-27 13:19:12.800421 | 2ce2661f-fea8-4b71-820b-0f571b3edb63 ==============================
[0m13:19:12.800421 [info ] [MainThread]: Running with dbt=1.4.7
[0m13:19:12.802837 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:19:12.803902 [debug] [MainThread]: Tracking: tracking
[0m13:19:12.806868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f5ff490f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f5ff497b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f5ff49390>]}
[0m13:19:12.822563 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m13:19:12.993986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:19:12.995573 [debug] [MainThread]: Partial parsing: added file: custom_postgres://macros/film_ratings_macro.sql
[0m13:19:12.996700 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m13:19:13.022975 [debug] [MainThread]: 1603: static parser failed on example/film_ratings.sql
[0m13:19:13.037976 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/film_ratings.sql
[0m13:19:13.102414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ce2661f-fea8-4b71-820b-0f571b3edb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f5e678e50>]}
[0m13:19:13.122257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ce2661f-fea8-4b71-820b-0f571b3edb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f5ff2a6b0>]}
[0m13:19:13.123453 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:19:13.124662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ce2661f-fea8-4b71-820b-0f571b3edb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f5ff4fbb0>]}
[0m13:19:13.127040 [info ] [MainThread]: 
[0m13:19:13.129907 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:19:13.132835 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m13:19:13.143942 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m13:19:13.145322 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m13:19:13.146668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:13.161994 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m13:19:13.164253 [debug] [ThreadPool]: On list_destination_db: Close
[0m13:19:13.167034 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m13:19:13.173470 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:19:13.174785 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m13:19:13.175865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:13.186922 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:19:13.188249 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:19:13.189264 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:19:13.192930 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m13:19:13.194996 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m13:19:13.198309 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m13:19:13.205338 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:13.206718 [debug] [MainThread]: On master: BEGIN
[0m13:19:13.207845 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:19:13.218465 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:19:13.219622 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:13.220523 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:19:13.227389 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m13:19:13.229623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ce2661f-fea8-4b71-820b-0f571b3edb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f5d70b910>]}
[0m13:19:13.230997 [debug] [MainThread]: On master: ROLLBACK
[0m13:19:13.234148 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:13.235369 [debug] [MainThread]: On master: BEGIN
[0m13:19:13.239013 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:19:13.240191 [debug] [MainThread]: On master: COMMIT
[0m13:19:13.241208 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:13.242022 [debug] [MainThread]: On master: COMMIT
[0m13:19:13.243975 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:19:13.244859 [debug] [MainThread]: On master: Close
[0m13:19:13.246025 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:19:13.247269 [info ] [MainThread]: 
[0m13:19:13.262082 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m13:19:13.263509 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m13:19:13.265152 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m13:19:13.266477 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m13:19:13.270140 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m13:19:13.282959 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-03-27 13:19:13.267758 => 2024-03-27 13:19:13.282835
[0m13:19:13.284264 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m13:19:13.322879 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m13:19:13.333282 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:19:13.334491 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m13:19:13.335553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:13.346271 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:19:13.347404 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:19:13.348335 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m13:19:13.355208 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:19:13.361803 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:19:13.363097 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m13:19:13.366743 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:19:13.370258 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:19:13.371536 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m13:19:13.374923 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:19:13.397098 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m13:19:13.398678 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:19:13.399916 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m13:19:13.403907 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:19:13.409531 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:19:13.410778 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m13:19:13.416024 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:19:13.418307 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-03-27 13:19:13.285266 => 2024-03-27 13:19:13.418248
[0m13:19:13.419432 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m13:19:13.420889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ce2661f-fea8-4b71-820b-0f571b3edb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f5d744970>]}
[0m13:19:13.422240 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.16s]
[0m13:19:13.424925 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m13:19:13.426306 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m13:19:13.427432 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m13:19:13.428812 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m13:19:13.429864 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m13:19:13.433342 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m13:19:13.442236 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-03-27 13:19:13.430880 => 2024-03-27 13:19:13.442018
[0m13:19:13.443442 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m13:19:13.450308 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m13:19:13.459184 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:19:13.460414 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m13:19:13.461400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:13.471433 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:19:13.472666 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:19:13.473726 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m13:19:13.479117 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:19:13.484269 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:19:13.485520 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m13:19:13.487996 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:19:13.491386 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:19:13.492407 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m13:19:13.494805 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:19:13.497653 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m13:19:13.498959 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:19:13.499882 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m13:19:13.503644 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:19:13.506487 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:19:13.507571 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m13:19:13.511804 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:19:13.514008 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-03-27 13:19:13.444533 => 2024-03-27 13:19:13.513940
[0m13:19:13.515156 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m13:19:13.516668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ce2661f-fea8-4b71-820b-0f571b3edb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f5d5e1090>]}
[0m13:19:13.517856 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.09s]
[0m13:19:13.519243 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m13:19:13.520357 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m13:19:13.521569 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m13:19:13.522868 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m13:19:13.523752 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m13:19:13.526864 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m13:19:13.535635 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-03-27 13:19:13.524520 => 2024-03-27 13:19:13.535423
[0m13:19:13.536831 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m13:19:13.541494 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m13:19:13.550995 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:19:13.552067 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m13:19:13.553008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:13.562661 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:19:13.563880 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:19:13.564841 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m13:19:13.571391 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:19:13.574818 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:19:13.575788 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m13:19:13.578110 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:19:13.581557 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:19:13.582667 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m13:19:13.585179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:19:13.587790 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m13:19:13.588803 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:19:13.589716 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m13:19:13.592828 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:19:13.595567 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:19:13.596551 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m13:19:13.600986 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:19:13.603373 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-03-27 13:19:13.537703 => 2024-03-27 13:19:13.603322
[0m13:19:13.604351 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m13:19:13.605794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ce2661f-fea8-4b71-820b-0f571b3edb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f5d5e0f40>]}
[0m13:19:13.607099 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.08s]
[0m13:19:13.608378 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m13:19:13.610397 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m13:19:13.611522 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m13:19:13.613088 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m13:19:13.614149 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m13:19:13.617655 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m13:19:13.626200 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-03-27 13:19:13.615207 => 2024-03-27 13:19:13.626003
[0m13:19:13.627171 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m13:19:13.633261 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m13:19:13.642033 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:19:13.643134 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m13:19:13.643999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:13.654183 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:19:13.655398 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:19:13.656523 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    
WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT  
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title 
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id

  );
  
[0m13:19:13.668603 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:19:13.672192 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:19:13.673220 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m13:19:13.676090 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:19:13.678524 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m13:19:13.679541 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:19:13.680486 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m13:19:13.684536 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:19:13.687665 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:19:13.688880 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m13:19:13.691842 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:19:13.693697 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-03-27 13:19:13.627969 => 2024-03-27 13:19:13.693648
[0m13:19:13.694710 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m13:19:13.695958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ce2661f-fea8-4b71-820b-0f571b3edb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f5d783a00>]}
[0m13:19:13.697200 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.08s]
[0m13:19:13.698493 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m13:19:13.701026 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:19:13.702071 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:13.703039 [debug] [MainThread]: On master: BEGIN
[0m13:19:13.703971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:19:13.714195 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:19:13.715393 [debug] [MainThread]: On master: COMMIT
[0m13:19:13.717192 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:13.718412 [debug] [MainThread]: On master: COMMIT
[0m13:19:13.721184 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:19:13.722621 [debug] [MainThread]: On master: Close
[0m13:19:13.725938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:13.727135 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m13:19:13.728214 [info ] [MainThread]: 
[0m13:19:13.729617 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m13:19:13.731603 [debug] [MainThread]: Command end result
[0m13:19:13.756127 [info ] [MainThread]: 
[0m13:19:13.757050 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:19:13.758141 [info ] [MainThread]: 
[0m13:19:13.759094 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:19:13.760238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f5d62baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f5e67b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f5e67bbb0>]}
[0m13:19:13.761344 [debug] [MainThread]: Flushing usage events


============================== 2024-03-27 13:21:43.250799 | 52ca8a42-6ac7-4a6a-9974-a0484aa837b1 ==============================
[0m13:21:43.250799 [info ] [MainThread]: Running with dbt=1.4.7
[0m13:21:43.253083 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:21:43.254269 [debug] [MainThread]: Tracking: tracking
[0m13:21:43.257820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0df5985360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0df59857e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0df59853c0>]}
[0m13:21:43.276286 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m13:21:43.452556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:21:43.454301 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://macros/film_ratings_macro.sql
[0m13:21:43.479549 [debug] [MainThread]: 1603: static parser failed on example/film_ratings.sql
[0m13:21:43.496006 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/film_ratings.sql
[0m13:21:43.561388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52ca8a42-6ac7-4a6a-9974-a0484aa837b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0df40c4bb0>]}
[0m13:21:43.581043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52ca8a42-6ac7-4a6a-9974-a0484aa837b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0df5956770>]}
[0m13:21:43.582546 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:21:43.583830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52ca8a42-6ac7-4a6a-9974-a0484aa837b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0df5956680>]}
[0m13:21:43.586340 [info ] [MainThread]: 
[0m13:21:43.588973 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:21:43.591873 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m13:21:43.604834 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m13:21:43.606361 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m13:21:43.607795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:43.623081 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m13:21:43.625329 [debug] [ThreadPool]: On list_destination_db: Close
[0m13:21:43.628349 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m13:21:43.635050 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:21:43.636647 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m13:21:43.637979 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:43.650764 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:21:43.652313 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:21:43.653530 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:21:43.658177 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m13:21:43.660754 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m13:21:43.664275 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m13:21:43.672457 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:43.673589 [debug] [MainThread]: On master: BEGIN
[0m13:21:43.674821 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:43.685788 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:21:43.687086 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:43.688184 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:21:43.695918 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m13:21:43.698083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52ca8a42-6ac7-4a6a-9974-a0484aa837b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0df599d450>]}
[0m13:21:43.699564 [debug] [MainThread]: On master: ROLLBACK
[0m13:21:43.702624 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:43.703896 [debug] [MainThread]: On master: BEGIN
[0m13:21:43.708277 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:21:43.709441 [debug] [MainThread]: On master: COMMIT
[0m13:21:43.710518 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:43.711544 [debug] [MainThread]: On master: COMMIT
[0m13:21:43.714425 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:21:43.715598 [debug] [MainThread]: On master: Close
[0m13:21:43.716965 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:21:43.718391 [info ] [MainThread]: 
[0m13:21:43.734712 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m13:21:43.736598 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m13:21:43.738273 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m13:21:43.739838 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m13:21:43.744034 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m13:21:43.755686 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-03-27 13:21:43.741121 => 2024-03-27 13:21:43.755573
[0m13:21:43.756999 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m13:21:43.796992 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m13:21:43.806718 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:21:43.807839 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m13:21:43.808975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:43.819881 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:21:43.820938 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:21:43.821961 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m13:21:43.828987 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:21:43.835787 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:21:43.836958 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m13:21:43.840168 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:21:43.843645 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:21:43.844686 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m13:21:43.847688 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:21:43.868985 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m13:21:43.870482 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:21:43.871803 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m13:21:43.876279 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:21:43.882142 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:21:43.883464 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m13:21:43.889293 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:21:43.891722 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-03-27 13:21:43.757934 => 2024-03-27 13:21:43.891667
[0m13:21:43.892824 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m13:21:43.894550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52ca8a42-6ac7-4a6a-9974-a0484aa837b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0df2fdc9d0>]}
[0m13:21:43.895980 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.16s]
[0m13:21:43.898562 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m13:21:43.899950 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m13:21:43.901206 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m13:21:43.902848 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m13:21:43.904082 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m13:21:43.907385 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m13:21:43.917748 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-03-27 13:21:43.905119 => 2024-03-27 13:21:43.917521
[0m13:21:43.918980 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m13:21:43.924520 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m13:21:43.935250 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:21:43.936534 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m13:21:43.937768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:43.947364 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:21:43.948706 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:21:43.949645 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m13:21:43.959167 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:21:43.962909 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:21:43.964290 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m13:21:43.967381 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:21:43.970786 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:21:43.971952 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m13:21:43.974597 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:21:43.977253 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m13:21:43.978852 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:21:43.980263 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m13:21:43.984667 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:21:43.987780 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:21:43.988965 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m13:21:43.993729 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:21:43.995920 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-03-27 13:21:43.919932 => 2024-03-27 13:21:43.995866
[0m13:21:43.996994 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m13:21:43.998631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52ca8a42-6ac7-4a6a-9974-a0484aa837b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0df2f4c040>]}
[0m13:21:43.999892 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.10s]
[0m13:21:44.000969 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m13:21:44.002234 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m13:21:44.003534 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m13:21:44.005011 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m13:21:44.006139 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m13:21:44.009640 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m13:21:44.021798 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-03-27 13:21:44.007175 => 2024-03-27 13:21:44.021684
[0m13:21:44.023073 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m13:21:44.028048 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m13:21:44.036426 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:21:44.037414 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m13:21:44.038368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:44.048052 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:21:44.049107 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:21:44.050139 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m13:21:44.056298 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:21:44.059852 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:21:44.060988 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m13:21:44.064021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:21:44.067520 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:21:44.068777 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m13:21:44.071847 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:21:44.074545 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m13:21:44.075581 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:21:44.076891 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m13:21:44.080807 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:21:44.083745 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:21:44.084832 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m13:21:44.089622 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:21:44.091703 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-03-27 13:21:44.024215 => 2024-03-27 13:21:44.091651
[0m13:21:44.092835 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m13:21:44.094408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52ca8a42-6ac7-4a6a-9974-a0484aa837b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0df2fdea10>]}
[0m13:21:44.095996 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.09s]
[0m13:21:44.097191 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m13:21:44.099405 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m13:21:44.100802 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m13:21:44.102239 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m13:21:44.103418 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m13:21:44.108295 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m13:21:44.119300 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-03-27 13:21:44.104790 => 2024-03-27 13:21:44.119114
[0m13:21:44.120593 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m13:21:44.125151 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m13:21:44.137942 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:21:44.139075 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m13:21:44.140131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:44.151071 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:21:44.152064 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:21:44.153056 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT  
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title 
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m13:21:44.164745 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:21:44.168297 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:21:44.169549 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m13:21:44.173166 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:21:44.175791 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m13:21:44.177011 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:21:44.178126 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m13:21:44.182701 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:21:44.185691 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:21:44.186824 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m13:21:44.189762 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:21:44.191971 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-03-27 13:21:44.121412 => 2024-03-27 13:21:44.191920
[0m13:21:44.193107 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m13:21:44.194671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52ca8a42-6ac7-4a6a-9974-a0484aa837b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0df2e83ca0>]}
[0m13:21:44.196073 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.09s]
[0m13:21:44.197261 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m13:21:44.200096 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:21:44.201436 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:44.202425 [debug] [MainThread]: On master: BEGIN
[0m13:21:44.203414 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:44.212321 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:21:44.213521 [debug] [MainThread]: On master: COMMIT
[0m13:21:44.214422 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:44.215214 [debug] [MainThread]: On master: COMMIT
[0m13:21:44.217287 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:21:44.218204 [debug] [MainThread]: On master: Close
[0m13:21:44.219420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:44.220489 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m13:21:44.221411 [info ] [MainThread]: 
[0m13:21:44.222362 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m13:21:44.223502 [debug] [MainThread]: Command end result
[0m13:21:44.241507 [info ] [MainThread]: 
[0m13:21:44.242890 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:44.244886 [info ] [MainThread]: 
[0m13:21:44.246320 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:21:44.247713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0df2e60a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0df40bd4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0df2f34d30>]}
[0m13:21:44.248917 [debug] [MainThread]: Flushing usage events


============================== 2024-03-27 13:25:01.241336 | bf4239dd-e95e-43c6-a4c3-0f938a20158e ==============================
[0m13:25:01.241336 [info ] [MainThread]: Running with dbt=1.4.7
[0m13:25:01.243965 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:25:01.245104 [debug] [MainThread]: Tracking: tracking
[0m13:25:01.247701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab9ec64b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab9ec67040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab9ec64af0>]}
[0m13:25:01.266834 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m13:25:01.434453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:25:01.435480 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:25:01.442798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf4239dd-e95e-43c6-a4c3-0f938a20158e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab9d31cc70>]}
[0m13:25:01.468692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf4239dd-e95e-43c6-a4c3-0f938a20158e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab9d2e6230>]}
[0m13:25:01.469892 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:25:01.470989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf4239dd-e95e-43c6-a4c3-0f938a20158e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab9d2e6290>]}
[0m13:25:01.473561 [info ] [MainThread]: 
[0m13:25:01.476475 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:25:01.478777 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m13:25:01.489990 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m13:25:01.491593 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m13:25:01.493025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:01.509745 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m13:25:01.511807 [debug] [ThreadPool]: On list_destination_db: Close
[0m13:25:01.514185 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m13:25:01.520940 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:25:01.522171 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m13:25:01.523032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:01.531910 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:25:01.532993 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:25:01.534062 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:25:01.542604 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m13:25:01.544714 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m13:25:01.546757 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m13:25:01.553606 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:01.554742 [debug] [MainThread]: On master: BEGIN
[0m13:25:01.555964 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:25:01.564342 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:25:01.565409 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:01.566279 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:25:01.578189 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m13:25:01.580001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf4239dd-e95e-43c6-a4c3-0f938a20158e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab9d363850>]}
[0m13:25:01.580959 [debug] [MainThread]: On master: ROLLBACK
[0m13:25:01.582702 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:01.583524 [debug] [MainThread]: On master: BEGIN
[0m13:25:01.586262 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:25:01.587138 [debug] [MainThread]: On master: COMMIT
[0m13:25:01.587877 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:01.588587 [debug] [MainThread]: On master: COMMIT
[0m13:25:01.590427 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:25:01.591424 [debug] [MainThread]: On master: Close
[0m13:25:01.592794 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:25:01.594343 [info ] [MainThread]: 
[0m13:25:01.598471 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m13:25:01.599566 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m13:25:01.600950 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m13:25:01.601860 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m13:25:01.605079 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m13:25:01.613012 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-03-27 13:25:01.602626 => 2024-03-27 13:25:01.612789
[0m13:25:01.614129 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m13:25:01.652846 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m13:25:01.660204 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:25:01.661112 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m13:25:01.662055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:01.669677 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:25:01.670526 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:25:01.671472 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m13:25:01.677631 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m13:25:01.684153 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:25:01.685072 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m13:25:01.687792 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:25:01.690987 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:25:01.692079 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m13:25:01.695310 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:25:01.717434 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m13:25:01.718811 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:25:01.719843 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m13:25:01.723810 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:25:01.730453 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:25:01.731977 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m13:25:01.737829 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:25:01.741218 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-03-27 13:25:01.614902 => 2024-03-27 13:25:01.741141
[0m13:25:01.742682 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m13:25:01.744491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf4239dd-e95e-43c6-a4c3-0f938a20158e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab9d189bd0>]}
[0m13:25:01.745978 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 40[0m in 0.14s]
[0m13:25:01.749399 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m13:25:01.750682 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m13:25:01.751830 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m13:25:01.753288 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m13:25:01.754407 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m13:25:01.758915 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m13:25:01.768137 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-03-27 13:25:01.755617 => 2024-03-27 13:25:01.767927
[0m13:25:01.769328 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m13:25:01.774438 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m13:25:01.785998 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:25:01.787462 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m13:25:01.788469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:01.797579 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:25:01.798555 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:25:01.799404 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m13:25:01.805315 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m13:25:01.808756 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:25:01.809929 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m13:25:01.812181 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:25:01.815454 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:25:01.816428 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m13:25:01.818652 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:25:01.821197 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m13:25:01.822044 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:25:01.822832 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m13:25:01.826365 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:25:01.829556 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:25:01.830490 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m13:25:01.834168 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:25:01.836079 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-03-27 13:25:01.770500 => 2024-03-27 13:25:01.836026
[0m13:25:01.837059 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m13:25:01.838498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf4239dd-e95e-43c6-a4c3-0f938a20158e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab9d18a140>]}
[0m13:25:01.839751 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 40[0m in 0.09s]
[0m13:25:01.841715 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m13:25:01.843072 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m13:25:01.844345 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m13:25:01.846066 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m13:25:01.847147 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m13:25:01.851589 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m13:25:01.860950 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-03-27 13:25:01.848036 => 2024-03-27 13:25:01.860734
[0m13:25:01.862029 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m13:25:01.866544 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m13:25:01.875415 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:25:01.876568 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m13:25:01.877692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:01.886441 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:25:01.887497 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:25:01.888308 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m13:25:01.893532 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m13:25:01.896945 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:25:01.897984 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m13:25:01.900366 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:25:01.903342 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:25:01.904321 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m13:25:01.906529 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:25:01.909289 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m13:25:01.910486 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:25:01.911399 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m13:25:01.915120 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:25:01.918025 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:25:01.919089 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m13:25:01.923291 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:25:01.925798 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-03-27 13:25:01.862897 => 2024-03-27 13:25:01.925743
[0m13:25:01.926935 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m13:25:01.928437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf4239dd-e95e-43c6-a4c3-0f938a20158e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab9d2268f0>]}
[0m13:25:01.929660 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 40[0m in 0.08s]
[0m13:25:01.930823 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m13:25:01.932519 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m13:25:01.933555 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m13:25:01.934944 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m13:25:01.936044 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m13:25:01.941181 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m13:25:01.949935 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-03-27 13:25:01.936888 => 2024-03-27 13:25:01.949737
[0m13:25:01.951097 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m13:25:01.955948 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m13:25:01.966457 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:25:01.967521 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m13:25:01.968550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:01.978037 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:25:01.979253 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:25:01.980422 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT  
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title 
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m13:25:01.994673 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m13:25:01.998206 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:25:01.999109 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings" rename to "film_ratings__dbt_backup"
[0m13:25:02.001959 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:25:02.005341 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:25:02.006584 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m13:25:02.009426 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:25:02.012527 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m13:25:02.013581 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:25:02.014712 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m13:25:02.019263 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:25:02.024080 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:25:02.025364 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m13:25:02.029911 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:25:02.032466 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-03-27 13:25:01.951813 => 2024-03-27 13:25:02.032413
[0m13:25:02.033664 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m13:25:02.035168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf4239dd-e95e-43c6-a4c3-0f938a20158e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab9d1cbfa0>]}
[0m13:25:02.036357 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 40[0m in 0.10s]
[0m13:25:02.037438 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m13:25:02.039591 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:25:02.040934 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:02.042081 [debug] [MainThread]: On master: BEGIN
[0m13:25:02.043329 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:25:02.053258 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:25:02.054455 [debug] [MainThread]: On master: COMMIT
[0m13:25:02.055466 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:02.056290 [debug] [MainThread]: On master: COMMIT
[0m13:25:02.059018 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:25:02.060451 [debug] [MainThread]: On master: Close
[0m13:25:02.061870 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:02.063022 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m13:25:02.064331 [info ] [MainThread]: 
[0m13:25:02.065424 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m13:25:02.066715 [debug] [MainThread]: Command end result
[0m13:25:02.085451 [info ] [MainThread]: 
[0m13:25:02.086774 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:25:02.088071 [info ] [MainThread]: 
[0m13:25:02.089190 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:25:02.090689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab9d27e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab9d26e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab9d26c880>]}
[0m13:25:02.092167 [debug] [MainThread]: Flushing usage events


============================== 2024-03-27 13:25:57.853756 | 91ac5a8f-9912-49e7-8af5-5f349cce1372 ==============================
[0m13:25:57.853756 [info ] [MainThread]: Running with dbt=1.4.7
[0m13:25:57.856115 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:25:57.857323 [debug] [MainThread]: Tracking: tracking
[0m13:25:57.859718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd564c0d360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd564c0d7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd564c0d3c0>]}
[0m13:25:57.879796 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m13:25:58.060765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:25:58.062140 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:25:58.069985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91ac5a8f-9912-49e7-8af5-5f349cce1372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56333cd60>]}
[0m13:25:58.091947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91ac5a8f-9912-49e7-8af5-5f349cce1372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd563482320>]}
[0m13:25:58.093509 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:25:58.094684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91ac5a8f-9912-49e7-8af5-5f349cce1372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd563482380>]}
[0m13:25:58.097353 [info ] [MainThread]: 
[0m13:25:58.100531 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:25:58.102812 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m13:25:58.115205 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m13:25:58.116692 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m13:25:58.117925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:58.133641 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m13:25:58.135490 [debug] [ThreadPool]: On list_destination_db: Close
[0m13:25:58.137877 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m13:25:58.144257 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:25:58.145667 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m13:25:58.146941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:58.158457 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:25:58.159579 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:25:58.160745 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:25:58.165666 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m13:25:58.167869 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m13:25:58.171058 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m13:25:58.178139 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:58.179559 [debug] [MainThread]: On master: BEGIN
[0m13:25:58.180979 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:25:58.193684 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:25:58.194749 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:58.195658 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:25:58.202683 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m13:25:58.205035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91ac5a8f-9912-49e7-8af5-5f349cce1372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56338b850>]}
[0m13:25:58.206532 [debug] [MainThread]: On master: ROLLBACK
[0m13:25:58.210780 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:58.212001 [debug] [MainThread]: On master: BEGIN
[0m13:25:58.215965 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:25:58.217050 [debug] [MainThread]: On master: COMMIT
[0m13:25:58.217918 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:58.218712 [debug] [MainThread]: On master: COMMIT
[0m13:25:58.221067 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:25:58.222027 [debug] [MainThread]: On master: Close
[0m13:25:58.223600 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:25:58.225937 [info ] [MainThread]: 
[0m13:25:58.239757 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m13:25:58.241477 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m13:25:58.243098 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m13:25:58.244415 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m13:25:58.248089 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m13:25:58.261240 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-03-27 13:25:58.245578 => 2024-03-27 13:25:58.261114
[0m13:25:58.262585 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m13:25:58.302923 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m13:25:58.313688 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:25:58.314907 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m13:25:58.315991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:58.326058 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:25:58.327110 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:25:58.328122 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m13:25:58.335636 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:25:58.342332 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:25:58.343780 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m13:25:58.347311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:25:58.350726 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:25:58.352013 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m13:25:58.355156 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:25:58.376929 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m13:25:58.378414 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:25:58.379676 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m13:25:58.384261 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:25:58.390020 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:25:58.391318 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m13:25:58.396544 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:25:58.398871 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-03-27 13:25:58.263606 => 2024-03-27 13:25:58.398815
[0m13:25:58.400067 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m13:25:58.401592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91ac5a8f-9912-49e7-8af5-5f349cce1372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5631fd2a0>]}
[0m13:25:58.402848 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.16s]
[0m13:25:58.405329 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m13:25:58.406964 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m13:25:58.408382 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m13:25:58.410094 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m13:25:58.411371 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m13:25:58.415070 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m13:25:58.426024 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-03-27 13:25:58.412754 => 2024-03-27 13:25:58.425809
[0m13:25:58.427392 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m13:25:58.432009 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m13:25:58.443331 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:25:58.444835 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m13:25:58.446049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:58.457989 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:25:58.459424 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:25:58.460648 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m13:25:58.470678 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:25:58.474264 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:25:58.475579 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m13:25:58.478827 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:25:58.482486 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:25:58.483825 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m13:25:58.487170 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:25:58.490219 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m13:25:58.491500 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:25:58.492821 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m13:25:58.497402 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:25:58.501224 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:25:58.502469 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m13:25:58.507178 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:25:58.509388 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-03-27 13:25:58.428392 => 2024-03-27 13:25:58.509336
[0m13:25:58.510479 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m13:25:58.511914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91ac5a8f-9912-49e7-8af5-5f349cce1372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5632742e0>]}
[0m13:25:58.513972 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.10s]
[0m13:25:58.515201 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m13:25:58.516398 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m13:25:58.517782 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m13:25:58.519205 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m13:25:58.520500 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m13:25:58.523864 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m13:25:58.534874 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-03-27 13:25:58.521527 => 2024-03-27 13:25:58.534748
[0m13:25:58.536035 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m13:25:58.540918 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m13:25:58.551621 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:25:58.552698 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m13:25:58.553719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:58.564730 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:25:58.565934 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:25:58.567167 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m13:25:58.573373 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:25:58.576840 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:25:58.578023 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m13:25:58.581006 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:25:58.584409 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:25:58.585556 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m13:25:58.588235 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:25:58.590873 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m13:25:58.592223 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:25:58.593353 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m13:25:58.597546 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:25:58.600829 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:25:58.602033 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m13:25:58.606921 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:25:58.609270 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-03-27 13:25:58.537170 => 2024-03-27 13:25:58.609201
[0m13:25:58.610502 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m13:25:58.612105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91ac5a8f-9912-49e7-8af5-5f349cce1372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd563266800>]}
[0m13:25:58.613519 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.09s]
[0m13:25:58.614720 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m13:25:58.616510 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m13:25:58.617825 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m13:25:58.619400 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m13:25:58.620721 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m13:25:58.627017 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m13:25:58.637158 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-03-27 13:25:58.621909 => 2024-03-27 13:25:58.636985
[0m13:25:58.638250 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m13:25:58.643592 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m13:25:58.654921 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:25:58.656272 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m13:25:58.657473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:58.669418 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:25:58.670627 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:25:58.671768 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT  
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title 
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m13:25:58.684146 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:25:58.687939 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:25:58.689133 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m13:25:58.692463 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:25:58.695225 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m13:25:58.696238 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:25:58.697186 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m13:25:58.701265 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:25:58.705562 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:25:58.706981 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m13:25:58.709762 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:25:58.711888 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-03-27 13:25:58.639342 => 2024-03-27 13:25:58.711828
[0m13:25:58.713117 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m13:25:58.714813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91ac5a8f-9912-49e7-8af5-5f349cce1372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd561093250>]}
[0m13:25:58.716010 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.10s]
[0m13:25:58.717357 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m13:25:58.719637 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:25:58.721004 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:58.722152 [debug] [MainThread]: On master: BEGIN
[0m13:25:58.723316 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:25:58.737838 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:25:58.740183 [debug] [MainThread]: On master: COMMIT
[0m13:25:58.742927 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:58.743991 [debug] [MainThread]: On master: COMMIT
[0m13:25:58.746436 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:25:58.747835 [debug] [MainThread]: On master: Close
[0m13:25:58.749457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:58.750470 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m13:25:58.751582 [info ] [MainThread]: 
[0m13:25:58.753036 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m13:25:58.754413 [debug] [MainThread]: Command end result
[0m13:25:58.770101 [info ] [MainThread]: 
[0m13:25:58.771207 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:25:58.772226 [info ] [MainThread]: 
[0m13:25:58.773549 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:25:58.775105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd563289630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5610920b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5610913f0>]}
[0m13:25:58.776501 [debug] [MainThread]: Flushing usage events


============================== 2024-03-27 13:29:13.255082 | bbbd30e7-4a06-4048-87ba-a6e15d4c202f ==============================
[0m13:29:13.255082 [info ] [MainThread]: Running with dbt=1.4.7
[0m13:29:13.257518 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:29:13.258740 [debug] [MainThread]: Tracking: tracking
[0m13:29:13.261659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ae7e1360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ae7e17e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ae7e13c0>]}
[0m13:29:13.278723 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m13:29:13.472485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:29:13.474109 [debug] [MainThread]: Partial parsing: added file: custom_postgres://models/example/specific_movie.sql
[0m13:29:13.497257 [debug] [MainThread]: 1603: static parser failed on example/specific_movie.sql
[0m13:29:13.513311 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/specific_movie.sql
[0m13:29:13.530328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbbd30e7-4a06-4048-87ba-a6e15d4c202f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65acf66290>]}
[0m13:29:13.549823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbbd30e7-4a06-4048-87ba-a6e15d4c202f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65acf30070>]}
[0m13:29:13.551103 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:29:13.552509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbbd30e7-4a06-4048-87ba-a6e15d4c202f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65acf30df0>]}
[0m13:29:13.555628 [info ] [MainThread]: 
[0m13:29:13.560528 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:29:13.563136 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m13:29:13.576017 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m13:29:13.577662 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m13:29:13.579025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:13.599051 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m13:29:13.601153 [debug] [ThreadPool]: On list_destination_db: Close
[0m13:29:13.604234 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m13:29:13.611469 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:29:13.612838 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m13:29:13.613716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:29:13.626808 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:29:13.628309 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:29:13.629588 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:29:13.634306 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m13:29:13.636778 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m13:29:13.640088 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m13:29:13.647289 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:13.648377 [debug] [MainThread]: On master: BEGIN
[0m13:29:13.649443 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:29:13.659600 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:29:13.660871 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:13.661822 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:29:13.668978 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m13:29:13.671192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbbd30e7-4a06-4048-87ba-a6e15d4c202f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65acf63f40>]}
[0m13:29:13.672626 [debug] [MainThread]: On master: ROLLBACK
[0m13:29:13.675332 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:13.676264 [debug] [MainThread]: On master: BEGIN
[0m13:29:13.679319 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:29:13.680749 [debug] [MainThread]: On master: COMMIT
[0m13:29:13.681588 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:13.682455 [debug] [MainThread]: On master: COMMIT
[0m13:29:13.684483 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:29:13.685479 [debug] [MainThread]: On master: Close
[0m13:29:13.687157 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:29:13.689010 [info ] [MainThread]: 
[0m13:29:13.704746 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m13:29:13.706143 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m13:29:13.707963 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m13:29:13.708983 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m13:29:13.712861 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m13:29:13.724129 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-03-27 13:29:13.709841 => 2024-03-27 13:29:13.723932
[0m13:29:13.726357 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m13:29:13.776927 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m13:29:13.784973 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:29:13.786568 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m13:29:13.789721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:13.800540 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:29:13.801947 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:29:13.803504 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m13:29:13.812986 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:29:13.821674 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:29:13.823195 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m13:29:13.826532 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:29:13.831224 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:29:13.832268 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m13:29:13.834825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:29:13.859782 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m13:29:13.860882 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:29:13.861879 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m13:29:13.865672 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:29:13.874701 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:29:13.875835 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m13:29:13.880158 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:29:13.883301 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-03-27 13:29:13.727558 => 2024-03-27 13:29:13.883239
[0m13:29:13.884342 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m13:29:13.886377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbbd30e7-4a06-4048-87ba-a6e15d4c202f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ace16860>]}
[0m13:29:13.889130 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.18s]
[0m13:29:13.894510 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m13:29:13.895779 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m13:29:13.896766 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m13:29:13.898567 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m13:29:13.899453 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m13:29:13.903361 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m13:29:13.912646 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-03-27 13:29:13.900193 => 2024-03-27 13:29:13.912485
[0m13:29:13.914036 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m13:29:13.921163 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m13:29:13.931306 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:29:13.932245 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m13:29:13.933317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:13.948462 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:29:13.950066 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:29:13.951125 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m13:29:13.957538 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:29:13.961577 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:29:13.962713 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m13:29:13.964813 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:29:13.968573 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:29:13.970027 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m13:29:13.973520 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:29:13.976686 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m13:29:13.977694 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:29:13.978518 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m13:29:13.981873 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:29:13.985953 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:29:13.987874 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m13:29:13.994016 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:29:13.996516 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-03-27 13:29:13.915022 => 2024-03-27 13:29:13.996441
[0m13:29:13.998904 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m13:29:14.000778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbbd30e7-4a06-4048-87ba-a6e15d4c202f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ace5bee0>]}
[0m13:29:14.002668 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.10s]
[0m13:29:14.004896 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m13:29:14.008271 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m13:29:14.009983 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m13:29:14.011770 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m13:29:14.013182 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m13:29:14.016880 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m13:29:14.026778 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-03-27 13:29:14.014163 => 2024-03-27 13:29:14.026618
[0m13:29:14.027934 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m13:29:14.034154 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m13:29:14.042990 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:29:14.043979 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m13:29:14.044797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:14.058264 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:29:14.059493 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:29:14.060440 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m13:29:14.066028 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:29:14.069902 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:29:14.072135 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m13:29:14.075414 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:29:14.079227 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:29:14.080305 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m13:29:14.082454 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:29:14.086029 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m13:29:14.087392 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:29:14.088437 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m13:29:14.092802 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:29:14.095974 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:29:14.097030 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m13:29:14.101087 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:29:14.103511 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-03-27 13:29:14.029191 => 2024-03-27 13:29:14.103449
[0m13:29:14.105270 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m13:29:14.106969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbbd30e7-4a06-4048-87ba-a6e15d4c202f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ac4966e0>]}
[0m13:29:14.108543 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.10s]
[0m13:29:14.110173 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m13:29:14.112161 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m13:29:14.113270 [info ] [Thread-1 (]: 4 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m13:29:14.114715 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m13:29:14.116020 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m13:29:14.121328 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m13:29:14.130507 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-03-27 13:29:14.116859 => 2024-03-27 13:29:14.130381
[0m13:29:14.131500 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m13:29:14.136260 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m13:29:14.146045 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:29:14.147251 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m13:29:14.148195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:14.159281 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:29:14.160537 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:29:14.161565 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS (
    SELECT  
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title 
)

SELECT 
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m13:29:14.172743 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:29:14.177413 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:29:14.178539 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m13:29:14.180758 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:29:14.183169 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m13:29:14.184118 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:29:14.184883 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m13:29:14.188736 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:29:14.192156 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:29:14.193715 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m13:29:14.196270 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:29:14.198425 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-03-27 13:29:14.132304 => 2024-03-27 13:29:14.198321
[0m13:29:14.199346 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m13:29:14.200678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbbd30e7-4a06-4048-87ba-a6e15d4c202f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65acf643d0>]}
[0m13:29:14.201877 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.09s]
[0m13:29:14.203268 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m13:29:14.205035 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m13:29:14.206315 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m13:29:14.210569 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m13:29:14.211580 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m13:29:14.215483 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m13:29:14.224992 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2024-03-27 13:29:14.212414 => 2024-03-27 13:29:14.224827
[0m13:29:14.226352 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m13:29:14.233227 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m13:29:14.242603 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m13:29:14.243572 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m13:29:14.244431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:14.256642 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:29:14.258249 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m13:29:14.259567 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    

SELECT *
FROM "destination_db"."public"."films"
WHERE title = 'Dunkirk'
  );
  
[0m13:29:14.265923 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m13:29:14.269999 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m13:29:14.271386 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m13:29:14.274052 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:29:14.277106 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m13:29:14.278541 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m13:29:14.279528 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m13:29:14.282920 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:29:14.287193 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m13:29:14.288507 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m13:29:14.291894 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:29:14.294101 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2024-03-27 13:29:14.227337 => 2024-03-27 13:29:14.294043
[0m13:29:14.295149 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m13:29:14.296543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbbd30e7-4a06-4048-87ba-a6e15d4c202f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ac48e440>]}
[0m13:29:14.298140 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 1[0m in 0.09s]
[0m13:29:14.299959 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m13:29:14.302640 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:29:14.304275 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:14.305492 [debug] [MainThread]: On master: BEGIN
[0m13:29:14.306587 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:29:14.317642 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:29:14.318612 [debug] [MainThread]: On master: COMMIT
[0m13:29:14.319967 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:14.321224 [debug] [MainThread]: On master: COMMIT
[0m13:29:14.323871 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:29:14.325803 [debug] [MainThread]: On master: Close
[0m13:29:14.327555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:14.328669 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m13:29:14.329881 [info ] [MainThread]: 
[0m13:29:14.331648 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m13:29:14.333074 [debug] [MainThread]: Command end result
[0m13:29:14.349415 [info ] [MainThread]: 
[0m13:29:14.350853 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:29:14.352160 [info ] [MainThread]: 
[0m13:29:14.353450 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:29:14.355532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ac4cd2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ace66d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ac48d1b0>]}
[0m13:29:14.356824 [debug] [MainThread]: Flushing usage events
